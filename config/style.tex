% << font family && font size >>
\setmainfont{Times New Roman}
\setsansfont{Times New Roman}
\setCJKmainfont{SimSun}
\setCJKsansfont{SimHei}
\renewcommand{\Huge}{\fontsize{26bp}{47.67bp}\selectfont}
\renewcommand{\huge}{\fontsize{24bp}{44bp}\selectfont}
\renewcommand{\Large}{\fontsize{18bp}{33bp}\selectfont}
\renewcommand{\large}{\fontsize{15bp}{27.5bp}\selectfont}
\renewcommand{\normalsize}{\fontsize{12bp}{20bp}\selectfont}
\renewcommand{\small}{\fontsize{10.5bp}{19.25bp}\selectfont}
\renewcommand{\footnotesize}{\fontsize{9bp}{16.5bp}\selectfont}
\renewcommand{\scriptsize}{\fontsize{7.5bp}{13.75bp}\selectfont}
\renewcommand{\tiny}{\fontsize{6.5bp}{12bp}\selectfont}
\renewcommand{\arraystretch}{0.8}

% << display skip >>
\setenumerate[1]{itemsep=0pt,topsep=0pt,parsep=0pt}
\renewcommand{\labelenumi}{(\theenumi) }
\setitemize[1]{itemsep=0pt,topsep=0pt,parsep=0pt}
\setlength{\abovecaptionskip}{5bp}
\setlength{\belowcaptionskip}{5bp}

% << wide space >>
\newcommand{\wsp}[1][1]{\hspace{#1\ccwd}}

% << page style >>
\geometry{
    paper       = a4paper,
    vmargin     = 2.54cm,
    hmargin     = 3.17cm,
    headheight  = 0.75cm,
    headsep     = 0.29cm,
    footskip    = 0.79cm,
}
\pagestyle{fancy}
\fancypagestyle{title}{
    \fancyhf{}
    \fancyhead[C]{\footnotesize\Title}
    \fancyfoot[C]{\footnotesize\thepage}
}
\fancypagestyle{plain}{
    \fancyhf{}
    \renewcommand{\headrulewidth}{0pt}
    \fancyhead[C]{}
    \fancyfoot[C]{\footnotesize\thepage}
}

% << caption style >>
\renewcommand{\thetable}{\thechapter-\arabic{table}}
\renewcommand{\thefigure}{\thechapter-\arabic{figure}}
\counterwithin{algorithm}{chapter}
\renewcommand{\thealgorithm}{\thechapter-\arabic{algorithm}}
\floatname{algorithm}{算法}
\renewcommand{\theequation}{\arabic{chapter}-\arabic{equation}}
\newtagform{equ}[]{式(}{)}
\usetagform{equ}

% << enumerate sep >>
\setenumerate[1]{itemsep=0pt,topsep=0pt,parsep=0pt}
\setitemize[1]{itemsep=0pt,topsep=0pt,parsep=0pt}

% << chapter >>
\ifPrint\@openrighttrue\else\@openrightfalse\fi
\renewcommand{\chapter}{
  \if@openright\cleardoublepage\else\clearpage\fi
  \global\@topnum\z@
  \@afterindenttrue
  \secdef\@chapter\@schapter
}

% << mainmatter >>
\renewcommand{\mainmatter}{
    \clearpage
    \pagestyle{title}
    \setcounter{page}{1}
    \setcounter{secnumdepth}{3}
    \ctexset{
        chapter = {
          format        = \sffamily\bfseries\fontsize{17bp}{26.67bp}\selectfont,
          aftername     = \wsp[1],
          number        = \thechapter,
          name          = {,},
          beforeskip    = 2em,
          afterskip     = 2em,
          fixskip       = true,
        },
        section = {
            format      = \sffamily\fontsize{15bp}{25.67bp}\selectfont,
            aftername   = \wsp[1],
            beforeskip  = 2em,
            afterskip   = 2em,
            fixskip     = true,
        },
        subsection = {
          format        = \sffamily\fontsize{13bp}{25bp}\selectfont,
          aftername     = \wsp[0.5],
          beforeskip    = 2em,
          afterskip     = 2em,
          fixskip       = true,
          indent        = \z@,
        },
        subsubsection = {
          format        = \sffamily\fontsize{12bp}{25bp}\selectfont,
          aftername     = \wsp[0.5],
        %   beforeskip    = 2em,
          afterskip     = 2em,
          fixskip       = true,
          number        = \arabic{subsubsection},
          name          = {,.},
          indent        = 2\ccwd,
        },
        paragraph = {
          format    = \rmfamily\fontsize{12bp}{22bp}\selectfont,
          aftername = {},
          indent    = \ccwd,
        },
    }
}

% << aftermatter >>
\newcommand{\aftermatter}{
    \ctexset{
        chapter = {
            name        = {,},
            format      = \centering\sffamily\Large\selectfont,
            nameformat  = {},
            number      = \thechapter,
            aftername   = \hspace{\ccwd},
            beforeskip  = 2em,
            afterskip   = 2em,
            fixskip     = true,
        },
        section = {
            name        = {,},
            format      = \centering\sffamily\Large\selectfont,
            nameformat  = {},
            number      = \thechapter,
            aftername   = \hspace{\ccwd},
            beforeskip  = 1.5em,
            afterskip   = 1.5em,
            fixskip     = true,
        },
    }
}